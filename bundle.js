(()=>{"use strict";var e={247:(e,t,r)=>{e.exports=r.p+"edb30e59a0a192144da5.png"},496:(e,t,r)=>{e.exports=r.p+"6ff1bb526c5f53603f5f.png"},819:(e,t,r)=>{e.exports=r.p+"3282f18a9f5fbb412a27.png"},769:(e,t,r)=>{e.exports=r.p+"9c9cf8b15326b0e424b0.png"},420:(e,t,r)=>{e.exports=r.p+"a3561cc01dc44644ee84.png"},715:(e,t,r)=>{e.exports=r.p+"434e99b0ae1ebbed72bb.png"},217:(e,t,r)=>{e.exports=r.p+"7bdfa3713f4ba94f26d3.png"},30:(e,t,r)=>{e.exports=r.p+"ed9f20b785526dc26bb2.png"},837:(e,t,r)=>{e.exports=r.p+"295677352f3d91f36f24.png"}},t={};function r(n){var i=t[n];if(void 0!==i)return i.exports;var o=t[n]={exports:{}};return e[n](o,o.exports,r),o.exports}r.p="",(()=>{var e=document.getElementById("canvas"),t=e.getContext("2d");function n(e,t){return Math.floor(Math.random()*(t-e+1)+e)}function i(e){var t;return Array.isArray(e)&&(t=e[n(0,e.length-1)]),t}function o(e,t,r,n,i,o){return e>r&&e<r+i&&t>n&&t<n+o}function a(e,t,r){return(e-t)/(r-t)}function s(e){return JSON.parse(JSON.stringify(e))}var c,l,f,u,d,p=r(247),h=r(496),g=r(819),v=r(769),b=r(420),y=r(715),w=r(217),x=r(30),S=r(837);function m(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var O=new Image;O.src=p;var T=new Image;T.src=h;var I=new Image;I.src=g;var N=new Image;N.src=y;var A=new Image;A.src=w;var P=new Image;P.src=v;var H=new Image;H.src=b;var B=new Image;B.src=x;var E=new Image;E.src=S;var R=(m(c={},1,O),m(c,2,T),m(c,3,I),c),k=(m(l={},1,N),m(l,2,A),l),M=(m(d={},2,(m(f={},1,P),m(f,2,H),f)),m(d,1,(m(u={},1,B),m(u,2,E),u)),d);function C(){var e={};if((arguments.length<=0?void 0:arguments[0])instanceof Object){var t=arguments.length<=0?void 0:arguments[0];e.rows=t.rows,e.cols=t.cols,e.data=t.data}else e.rows=arguments.length<=0?void 0:arguments[0],e.cols=arguments.length<=1?void 0:arguments[1],e.data=new Array(e.rows).fill().map((function(){return new Array(e.cols).fill(0)}));return e}function D(e,t){if(t instanceof Object){if(e.cols!==t.rows)throw Error("Columns of A must match rows of B");return J(C(e.rows,t.cols),(function(r,n,i){for(var o=0,a=0;a<e.cols;a++)o+=e.data[n][a]*t.data[a][i];return o}))}return J(C(e.rows,e.cols),(function(r,n,i){return e.data[n][i]*t}))}function j(e,t){if(t instanceof Object){if(e.rows!==t.rows||e.cols!==t.cols)throw Error("Columns and Rows of A must match Columns and Rows of B");return J(C(e.rows,t.cols),(function(r,n,i){return e.data[n][i]+t.data[n][i]}))}return J(C(e.rows,e.cols),(function(r,n,i){return e.data[n][i]+t}))}function U(e){return J(e,(function(){return 2*Math.random()-1}))}function J(e,t){for(var r=0;r<e.rows;r++)for(var n=0;n<e.cols;n++){var i=e.data[r][n];e.data[r][n]=t(i,r,n)}return e}function V(){var e={};if((arguments.length<=0?void 0:arguments[0])instanceof Object){var t=arguments.length<=0?void 0:arguments[0];e.inputNodes=t.inputNodes,e.hiddenNodes=t.hiddenNodes,e.outputNodes=t.outputNodes,e.weightsIH=t.weightsIH,e.weightsHO=t.weightsHO,e.biasH=t.biasH,e.biasO=t.biasO}else e.inputNodes=arguments.length<=0?void 0:arguments[0],e.hiddenNodes=arguments.length<=1?void 0:arguments[1],e.outputNodes=arguments.length<=2?void 0:arguments[2],e.weightsIH=C(e.hiddenNodes,e.inputNodes),e.weightsHO=C(e.outputNodes,e.hiddenNodes),e.biasH=C(e.hiddenNodes,1),e.biasO=C(e.outputNodes,1),e.weightsIH=U(e.weightsIH),e.weightsHO=U(e.weightsHO),e.biasH=U(e.biasH),e.biasO=U(e.biasO);return e}function G(e,t){if(e.inputNodes!==t.inputNodes||e.hiddenNodes!==t.hiddenNodes||e.outputNodes!==t.outputNodes)throw Error("Number of nodes in A and B must match");return V({weightsIH:J(e.weightsIH,(function(e,r,n){return i([e,t.weightsIH.data[r][n]])})),weightsHO:J(e.weightsHO,(function(e,r,n){return i([e,t.weightsHO.data[r][n]])})),biasH:J(e.biasH,(function(e,r,n){return i([e,t.biasH.data[r][n]])})),biasO:J(e.biasO,(function(e,r,n){return i([e,t.biasO.data[r][n]])})),inputNodes:e.inputNodes,hiddenNodes:e.hiddenNodes,outputNodes:e.outputNodes})}function Y(e){return 1/(1+Math.exp(-e))}function q(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.x,r=e.y,n=e.dy,i=e.color,o=e.wing,a=e.brain,c={};return c.color=i||2,c.wing=o||2,c.x=t||50,c.y=r||50,c.dy=n||0,c.brain=a?s(a):V(5,8,2),c.distance=0,c.fitness=0,c}function F(e){e.dy+=.25,e.y+e.dy>0&&(e.y+=e.dy),e.distance+=1}function L(e){t.drawImage(M[e.color][e.wing],e.x,e.y,28,42)}function Q(t,r){for(var n=null,i=Number.POSITIVE_INFINITY,o=0;o<r.length;o++){var s=r[o].x-t.x;s>0&&s<i&&(i=s,n=r[o])}if(null!=n){var c=[],l=n.x-t.x,f=n.y-t.y;c[0]=a(t.y,0,e.height),c[1]=1-c[0],c[2]=a(l,0,e.width),c[3]=2===n.type?c[0]:a(f+272,0,e.height),c[4]=2===n.type?a(f,0,e.height):c[1];var u=function(e,t){var r,n=J(C((r=t).length,1),(function(e,t){return r[t]})),i=D(e.weightsIH,n);i=J(i=j(i,e.biasH),Y);var o=D(e.weightsHO,i);return function(e){for(var t=[],r=0;r<e.rows;r++)for(var n=0;n<e.cols;n++)t.push(e.data[r][n]);return t}(o=J(o=j(o,e.biasO),Y))}(t.brain,c);u[1]>u[0]&&K(t)}}function K(e){e.dy=-5,e.wing=1,setTimeout((function(){e.wing=2}),80)}function W(e){!function(e){for(var t=0;t<e.length;t++)e[t].distance=Math.pow(e[t].distance,2);for(var r=0,n=0;n<e.length;n++)r+=e[n].distance;for(var i=0;i<e.length;i++)e[i].fitness=e[i].distance/r}(e);var t=function(e){for(var t=[],r=0;r<e.length;r++)for(var n=100*e[r].fitness,i=0;i<n;i++)t.push(e[r]);return t}(e);return function(e){for(var t=[],r=0;r<500;r++){var n=(a=i(e),s=i(e),q({brain:G(a.brain,s.brain),color:i([a.color,s.color])}));o=X,function(e,t){e.weightsIH=J(e.weightsIH,t),e.weightsHO=J(e.weightsHO,t),e.biasH=J(e.biasH,t),e.biasO=J(e.biasO,t)}(n.brain,o),t.push(n)}var o,a,s;return t}(t)}function X(e){return Math.random()<.1?e+.5*Math.random():e}function $(t){if(t.y>e.height+10)return!0;for(var r=0;r<z.pipes.length;r++)if(n=t.x+4,i=t.y+4,24,38,o=z.pipes[r].x,a=z.pipes[r].y,32,272,!(n+24<o||o+32<n||i+38<a||a+272<i))return!0;var n,i,o,a;return!1}function _(e){switch(e){case 1:case 4:z.activeScreen=2;break;case 2:Z(),z.activeScreen=2;break;case 5:Z(),z.activeScreen=1;break;case 3:z.activeScreen=4;break;case 7:t=JSON.stringify(z),localStorage.setItem("state",t),alert("State successfully saved!");break;case 6:!function(){var e=localStorage.getItem("state");e?(z=JSON.parse(e),alert("State successfully loaded!")):alert("State was not found!")}();break;case 8:z.mode=1===z.mode?2:1;break;case 9:K(z.playerBird)}var t}var z={score:0,generation:1,bestScore:localStorage.getItem("bestScore")||0,bestDistance:0,mode:1,activeScreen:1,playerBird:q(),liveBirds:function(){for(var e=[],t=0;t<500;t++){var r=q({color:1});e.push(r)}return e}(),deadBirds:[],clouds:[],pipes:[]};function Z(){z.score=0,z.playerBird.x=50,z.playerBird.y=50,z.playerBird.dy=0,z.clouds=[],z.pipes=[]}function ee(e){e.x-=1}function te(e){e.x-=2}function re(e){return function(e){if(Array.isArray(e))return ne(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return ne(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?ne(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ne(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}const ie=function(){var r;t.fillStyle="#3cbcfc",t.fillRect(0,0,e.width,e.height),function(){if(z.clouds.length<5){var r=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.x,o=t.y,a=t.type,s={};return s.x=r||e.width+n(10,500),s.y=o||n(30,e.height-30),s.type=a||i([1,2,3]),s}();z.clouds.push(r)}for(var o=0;o<z.clouds.length;o++)a=z.clouds[o],t.drawImage(R[a.type],a.x,a.y),ee(z.clouds[o]),z.clouds[o].x<-50&&z.clouds.splice(o,1);var a}(),function(){if(z.pipes.length<5){var r=void 0;z.pipes.length>0&&(r=z.pipes[z.pipes.length-1].x+n(200,400));var o=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.x,o=t.y,a=t.type,s={};if(s.type=a||i([1,2]),s.x=r||e.width+n(10,500),o)s.y=o;else{var c=2===s.type?e.height-272:-100,l=2===s.type?e.height-172:0;s.y=n(c,l)}return s}({x:r});z.pipes.push(o)}for(var a=0;a<z.pipes.length;a++)s=z.pipes[a],t.drawImage(k[s.type],s.x,s.y),te(z.pipes[a]),z.pipes[a].x<-50&&(z.score+=1,z.pipes.splice(a,1));var s}(),t.font="14px PressStart2P",t.fillStyle="white",t.fillText("SCORE:".concat(z.score),10,10),t.font="14px PressStart2P",t.fillStyle="#f7dc6f",t.fillText("PAUSE",420,10),1===z.mode?(L(z.playerBird),F(z.playerBird),$(z.playerBird)&&(z.activeScreen=3,z.score>z.bestScore&&(r=z.score,z.bestScore=r,localStorage.setItem("bestScore",r)))):(t.font="14px PressStart2P",t.fillStyle="white",t.fillText("BEST-DISTANCE:".concat(z.bestDistance),10,26),t.fillText("GENERATION:".concat(z.generation),10,42),t.fillText("ALIVE:".concat(z.liveBirds.length,"/").concat(500),10,58),function(){for(var e=0;e<z.liveBirds.length;e++){var t;L(z.liveBirds[e]),F(z.liveBirds[e]),Q(z.liveBirds[e],z.pipes),$(z.liveBirds[e])&&(t=z.deadBirds).push.apply(t,re(z.liveBirds.splice(e,1))),0===z.liveBirds.length&&(z.generation+=1,z.bestDistance=Math.max.apply(Math,re(z.deadBirds.map((function(e){return e.distance}))).concat([z.bestDistance])),z.liveBirds=W(z.deadBirds),z.deadBirds=[],Z())}}())};function oe(){setTimeout((function(){requestAnimationFrame(oe),function(){switch(z.activeScreen){case 1:t.textBaseline="top",t.fillStyle="#3196ca",t.fillRect(0,0,e.width,e.height),t.fillStyle="white",t.font="72px PressStart2P",t.fillText("NEAT",110,60),t.font="56px PressStart2P",t.fillText("KOOPA",110,128),t.font="28px PressStart2P",t.fillText("PARATROOPA",110,182),t.fillStyle="#f7dc6f",t.font="16px PressStart2P",t.fillText("".concat(1===z.mode?">":" ","STANDARD MODE"),130,230),t.fillText("".concat(2===z.mode?">":" ","TRAINING MODE"),130,250),t.font="24px PressStart2P",t.fillText("START",190,300);break;case 2:ie();break;case 4:t.textBaseline="top",t.fillStyle="#3196ca",t.fillRect(0,0,e.width,e.height),t.fillStyle="white",t.font="44px PressStart2P",t.fillText("PAUSED",118,100),t.fillStyle="#f7dc6f",t.font="24px PressStart2P",t.fillText("RESUME",178,180),t.fillText("SAVE STATE",130,220),t.fillText("LOAD STATE",130,260),t.fillText("QUIT",202,300);break;case 3:t.textBaseline="top",t.fillStyle="#3196ca",t.fillRect(0,0,e.width,e.height),t.fillStyle="white",t.font="44px PressStart2P",t.fillText("GAME OVER",52,100),t.font="16px PressStart2P",t.fillText("YOUR SCORE",58,170),t.fillText(z.score,58,190),t.fillText("BEST SCORE",280,170),t.fillText(z.bestScore,280,190),t.fillStyle="#f7dc6f",t.font="24px PressStart2P",t.fillText("RESTART",166,250),t.fillText("QUIT",202,290)}}()}),10)}document.fonts.load("44px PressStart2P").then((function(){document.body.onkeyup=function(e){if(2===z.activeScreen){if("Space"==e.code)return _(9);if("Escape"==e.code)return _(3)}},e.onclick=function(t){var r=t.offsetX/e.offsetWidth*e.width,n=t.offsetY/e.offsetHeight*e.height;switch(z.activeScreen){case 1:if(o(r,n,132,230,224,36))return _(8);if(o(r,n,190,300,120,24))return _(1);break;case 2:if(o(r,n,420,10,80,14))return _(3);_(9);break;case 3:if(o(r,n,166,250,168,24))return _(2);if(o(r,n,202,290,96,24))return _(5);break;case 4:if(o(r,n,178,180,144,24))return _(4);if(o(r,n,130,220,240,24))return _(7);if(o(r,n,130,260,240,24))return _(6);if(o(r,n,202,296,96,24))return _(5)}},oe()})).catch((function(){alert("Couldn't load font!")})).finally((function(){document.querySelector("#loaderContainer").remove()}))})()})();